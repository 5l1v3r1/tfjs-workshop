<!-- Load TensorFlow.js. This is required to use MobileNet. -->
<script src="http://unpkg.com/@tensorflow/tfjs@1.0"></script>
<!-- Load the MobileNet model. -->
<script src="../dist/mobilenet.js"></script>

<div style='display: flex'>
  <!-- <img id="img" src="coffee.jpg"/> -->
  <img id="img" src="cat.jpg"/>
  <table id="predictions">
    <tr>
      <th align="right">Class</th>
      <th align="right">Probability</th> 
    </tr>
  </table>
  </div>

<script>
  const img = document.getElementById('img');
  const version = 2;
  const alpha = 0.5;

  async function run() {
    // Load the model.
    const model = await mobilenet.load(version, alpha);

    // Classify the image.
    const predictions = await model.classify(img);
    console.log('Predictions');

    const predictionsElement = document.getElementById('predictions');
    predictions.forEach(prediction => {
      const elem = document.createElement('tr');
      elem.innerHTML = `<th>${prediction.className}</th><th>${prediction.probability}</th>`;
      predictionsElement.appendChild(elem);
    });
    console.log(predictions);

    // Get the logits.
    const logits = model.infer(img);
    console.log('Logits');
    logits.print(true);

    // Get the embedding.
    const embedding = model.infer(img, true);
    console.log('Embedding');
    embedding.print(true);
  }
  run();
</script>





